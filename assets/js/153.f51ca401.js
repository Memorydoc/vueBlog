(window.webpackJsonp=window.webpackJsonp||[]).push([[153],{426:function(s,a,e){"use strict";e.r(a);var t=e(10),n=Object(t.a)({},function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"zookeeper-的数据模型"}},[s._v("Zookeeper 的数据模型")]),s._v(" "),e("p",[s._v("Zookeeper 的数据模型是什么样子呢？它很像数据结构当中的树，也很像文件系统的目录。\n"),e("img",{attrs:{src:"/img/microservice/zk12.png",alt:"zk1"}}),s._v("\n树是由节点所组成，Zookeeper 的数据存储也同样是基于节点，这种节点叫做 "),e("strong",[s._v("Znode")])]),s._v(" "),e("p",[s._v("但是，不同于树的节点，Znode 的引用方式是路径引用，类似于文件路径：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("/动物/猫\n/汽车/宝马\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("这样的层级结构，让每一个 Znode 节点拥有唯一的路径，就像命名空间一样对不同信息作出清晰的隔离。")]),s._v(" "),e("h4",{attrs:{id:"znode-包含哪些元素"}},[s._v("Znode 包含哪些元素")]),s._v(" "),e("p",[e("img",{attrs:{src:"/img/microservice/zk13.png",alt:"zk1"}})]),s._v(" "),e("ul",[e("li",[s._v("data：Znode 存储的数据信息。")]),s._v(" "),e("li",[s._v("ACL：记录 Znode 的访问权限，即哪些人或哪些 IP 可以访问本节点。")]),s._v(" "),e("li",[s._v("stat：包含 Znode 的各种元数据，比如事务 ID、版本号、时间戳、大小等等。")]),s._v(" "),e("li",[s._v("child：当前节点的子节点引用\n这里需要注意一点，Zookeeper 是为读多写少的场景所设计。Znode 并不是用来存储大规模业务数据，而是用于存储少量的状态和配置信息，"),e("strong",[s._v("每个节点的数据最大不能超过 1MB")]),s._v("。")])]),s._v(" "),e("h2",{attrs:{id:"zookeeper-的基本操作"}},[s._v("Zookeeper 的基本操作")]),s._v(" "),e("p",[s._v("创建节点")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("create\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("删除节点")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("delete\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("判断节点是否存在")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("exists\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("获得一个节点的数据")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("getData\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("设置一个节点的数据")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("setData\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("获取节点下的所有子节点")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("getChildren\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("这其中，"),e("code",[s._v("exists")]),s._v("，"),e("code",[s._v("getData")]),s._v("，"),e("code",[s._v("getChildren")]),s._v(" 属于读操作。Zookeeper 客户端在请求读操作的时候，可以选择是否设置 "),e("strong",[s._v("Watch")])]),s._v(" "),e("h2",{attrs:{id:"zookeeper-的事件通知"}},[s._v("Zookeeper 的事件通知")]),s._v(" "),e("p",[s._v("我们可以把 "),e("code",[s._v("Watch")]),s._v(" 理解成是注册在特定 Znode 上的触发器。当这个 Znode 发生改变，也就是调用了 "),e("code",[s._v("create")]),s._v(" "),e("code",[s._v("delete")]),s._v(" "),e("code",[s._v("setData")]),s._v("方法的时候，将会触发 "),e("code",[s._v("Znode")]),s._v(" 上注册的对应事件，请求 Watch 的客户端会接收到异步通知。")]),s._v(" "),e("p",[s._v("具体交互过程如下：")]),s._v(" "),e("ul",[e("li",[s._v("客户端调用 "),e("code",[s._v("getData")]),s._v(" 方法，"),e("code",[s._v("watch")]),s._v(" 参数是 true。服务端接到请求，返回节点数据，并且在对应的哈希表里插入被 Watch 的 Znode 路径，以及 Watcher 列表。\n"),e("img",{attrs:{src:"/img/microservice/zk14.png",alt:"memorydoc"}})]),s._v(" "),e("li",[s._v("当被 Watch 的 Znode 已删除，服务端会查找哈希表，找到该 Znode 对应的所有 Watcher，异步通知客户端，并且删除哈希表中对应的 Key-Value。\n"),e("img",{attrs:{src:"/img/microservice/zk15.png",alt:"memorydoc"}})])]),s._v(" "),e("h2",{attrs:{id:"zookeeper-的一致性"}},[s._v("Zookeeper 的一致性")]),s._v(" "),e("p",[s._v("Zookeeper 身为分布式系统协调服务，如果自身挂了如何处理呢？为了防止单机挂掉的情况，Zookeeper 维护了一个集群。如下图：")]),s._v(" "),e("p",[e("img",{attrs:{src:"/img/microservice/zk16.png",alt:"memorydoc"}})]),s._v(" "),e("p",[s._v("Zookeeper Service 集群是一主多从结构。")]),s._v(" "),e("p",[s._v("在更新数据时，首先更新到主节点（这里的节点是指服务器，不是 Znode），再同步到从节点。")]),s._v(" "),e("p",[s._v("在读取数据时，直接读取任意从节点。")]),s._v(" "),e("p",[s._v("为了保证主从节点的数据一致性，Zookeeper 采用了 ** ZAB 协议**，这种协议非常类似于一致性算法 "),e("strong",[s._v("Paxos")]),s._v(" 和 "),e("strong",[s._v("Raft")]),s._v("。")]),s._v(" "),e("hr"),s._v(" "),e("h4",{attrs:{id:"什么是-zab"}},[s._v("什么是 ZAB")]),s._v(" "),e("p",[s._v("Zookeeper Atomic Broadcast，有效解决了 Zookeeper 集群崩溃恢复，以及主从同步数据的问题。")]),s._v(" "),e("h4",{attrs:{id:"zab-协议定义的三种节点状态"}},[s._v("ZAB 协议定义的三种节点状态")]),s._v(" "),e("ul",[e("li",[s._v("Looking ：选举状态。")]),s._v(" "),e("li",[s._v("Following ：Follower 节点（从节点）所处的状态。")]),s._v(" "),e("li",[s._v("Leading ：Leader 节点（主节点）所处状态。")])]),s._v(" "),e("h4",{attrs:{id:"最大-zxid"}},[s._v("最大 ZXID")]),s._v(" "),e("p",[s._v("最大 ZXID 也就是节点本地的最新事务编号，包含 epoch 和计数两部分。epoch 是纪元的意思，相当于 Raft 算法选主时候的 term。")]),s._v(" "),e("h4",{attrs:{id:"zab-的崩溃恢复"}},[s._v("ZAB 的崩溃恢复")]),s._v(" "),e("p",[s._v("假如 Zookeeper 当前的主节点挂掉了，集群会进行崩溃恢复。ZAB 的崩溃恢复分成三个阶段：")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Leader election")])])]),s._v(" "),e("p",[s._v("选举阶段，此时集群中的节点处于 Looking 状态。它们会各自向其他节点发起投票，投票当中包含自己的服务器 ID 和最新事务 ID（ZXID）。")]),s._v(" "),e("p",[e("img",{attrs:{src:"/img/microservice/zk17.png",alt:"memorydoc"}})]),s._v(" "),e("p",[s._v("接下来，节点会用自身的 ZXID 和从其他节点接收到的 ZXID 做比较，如果发现别人家的 ZXID 比自己大，也就是数据比自己新，那么就重新发起投票，投票给目前已知最大的 ZXID 所属节点。")]),s._v(" "),e("p",[e("img",{attrs:{src:"/img/microservice/zk18.png",alt:"memorydoc"}})]),s._v(" "),e("p",[s._v("每次投票后，服务器都会统计投票数量，判断是否有某个节点得到半数以上的投票。如果存在这样的节点，该节点将会成为准 Leader，状态变为 Leading。其他节点的状态变为 Following。")]),s._v(" "),e("p",[e("img",{attrs:{src:"/img/microservice/zk19.png",alt:"memorydoc"}})]),s._v(" "),e("hr"),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Discovery")])])]),s._v(" "),e("p",[s._v("发现阶段，用于在从节点中发现最新的 ZXID 和事务日志。或许有人会问：既然 Leader 被选为主节点，已经是集群里数据最新的了，为什么还要从节点中寻找最新事务呢？")]),s._v(" "),e("p",[s._v("这是为了防止某些意外情况，比如因网络原因在上一阶段产生多个 Leader 的情况。")]),s._v(" "),e("p",[s._v("所以这一阶段，Leader 集思广益，接收所有 Follower 发来各自的最新 epoch 值。Leader 从中选出最大的 epoch，基于此值加 1，生成新的 epoch 分发给各个 Follower。")]),s._v(" "),e("p",[s._v("各个 Follower 收到全新的 epoch 后，返回 ACK 给 Leader，带上各自最大的 ZXID 和历史事务日志。Leader 选出最大的 ZXID，并更新自身历史日志。")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Synchronization")])])]),s._v(" "),e("p",[s._v("同步阶段，把 Leader 刚才收集得到的最新历史事务日志，同步给集群中所有的 Follower。只有当半数 Follower 同步成功，这个准 Leader 才能成为正式的 Leader。")]),s._v(" "),e("p",[s._v("自此，故障恢复正式完成")]),s._v(" "),e("hr"),s._v(" "),e("p",[e("strong",[s._v("ZAB 的数据写入")])]),s._v(" "),e("p",[e("strong",[s._v("Broadcast")])]),s._v(" "),e("p",[s._v("ZAB 的数据写入涉及到 Broadcast 阶段，简单来说，就是 Zookeeper 常规情况下更新数据的时候，由 Leader 广播到所有的 Follower。其过程如下：")]),s._v(" "),e("ul",[e("li",[s._v("客户端发出写入数据请求给任意 Follower。")]),s._v(" "),e("li",[s._v("Follower 把写入数据请求转发给 Leader。")]),s._v(" "),e("li",[s._v("Leader 采用二阶段提交方式，先发送 Propose 广播给 Follower。")]),s._v(" "),e("li",[s._v("Follower 接到 Propose 消息，写入日志成功后，返回 ACK 消息给 Leader。")]),s._v(" "),e("li",[s._v("Leader 接到半数以上ACK消息，返回成功给客户端，并且广播 Commit 请求给 Follower")])]),s._v(" "),e("p",[e("img",{attrs:{src:"/img/microservice/zk20.png",alt:"memorydoc"}})]),s._v(" "),e("p",[s._v("ZAB 协议既不是强一致性，也不是弱一致性，而是处于两者之间的 "),e("strong",[s._v("单调一致性（顺序一致性）")]),s._v("。它依靠事务 ID 和版本号，保证了数据的更新和读取是有序的。")]),s._v(" "),e("h2",{attrs:{id:"zookeeper-的应用场景"}},[s._v("Zookeeper 的应用场景")]),s._v(" "),e("h4",{attrs:{id:"分布式锁"}},[s._v("分布式锁")]),s._v(" "),e("p",[s._v("这是雅虎研究员设计 Zookeeper 的初衷。利用 Zookeeper 的临时顺序节点，可以轻松实现分布式锁。")]),s._v(" "),e("h4",{attrs:{id:"服务注册和发现"}},[s._v("服务注册和发现")]),s._v(" "),e("p",[s._v("利用 Znode 和 Watcher，可以实现分布式服务的注册和发现。最著名的应用就是阿里的分布式 RPC 框架 Dubbo。")]),s._v(" "),e("h4",{attrs:{id:"共享配置和状态信息"}},[s._v("共享配置和状态信息")]),s._v(" "),e("p",[s._v("Redis 的分布式解决方案 Codis，就利用了 Zookeeper 来存放数据路由表和 codis-proxy 节点的元信息。同时 codis-config 发起的命令都会通过 ZooKeeper 同步到各个存活的 codis-proxy。")]),s._v(" "),e("p",[s._v("此外，Kafka、HBase、Hadoop，也都依靠Zookeeper同步节点信息，实现高可用。")]),s._v(" "),e("h2",{attrs:{id:"基于-docker-安装-zookeeper"}},[s._v("基于 Docker 安装 Zookeeper")]),s._v(" "),e("h3",{attrs:{id:"概述"}},[s._v("概述")]),s._v(" "),e("p",[s._v("Zookeeper 部署有三种方式，单机模式、集群模式、伪集群模式，以下采用 Docker 的方式部署")]),s._v(" "),e("p",[e("strong",[s._v("注意：")]),s._v(" 集群为大于等于3个奇数，如 3、5、7,不宜太多，集群机器多了选举和数据同步耗时长，不稳定。")]),s._v(" "),e("h3",{attrs:{id:"单机模式"}},[s._v("单机模式")]),s._v(" "),e("h4",{attrs:{id:"docker-compose-yml"}},[s._v("docker-compose.yml")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("version: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\n\nservices:\n    zoo1:\n        image: zookeeper\n        restart: always\n        hostname: zoo1\n        ports:\n            - "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v(":2181\n        environment:\n            ZOO_MY_ID: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n            ZOO_SERVERS: server.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo1:2888:3888\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h4",{attrs:{id:"验证是否安装成功"}},[s._v("验证是否安装成功")]),s._v(" "),e("ul",[e("li",[s._v("以交互的方式进入容器")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it zookeeper_zoo1_1 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("使用客户端连接到服务端")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("bash-4.3"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/zkCli.sh -server 192.168.75.130:2181")]),s._v("\nConnecting to "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2181\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,365 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:zookeeper.version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.4")]),s._v(".10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":13 GMT\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,374 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:host.name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo1\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,374 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:java.version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),s._v(".0_131\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,380 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:java.vendor"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Oracle Corporation\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,381 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:java.home"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib/jvm/java-1.8-openjdk/jre\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,381 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:java.class.path"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/build/classes:/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/build/lib/*.jar:/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/lib/slf4j-log4j12-1.6.1.jar:/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/lib/slf4j-api-1.6.1.jar:/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/lib/netty-3.10.5.Final.jar:/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/lib/log4j-1.2.16.jar:/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/lib/jline-0.9.94.jar:/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/zookeeper-3.4.10.jar:/zookeeper-3.4.10/bin/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/src/java/lib/*.jar:/conf:\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,381 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:java.library.path"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64/server:/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64:/usr/lib/jvm/java-1.8-openjdk/jre/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/lib/amd64:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,381 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:java.io.tmpdir"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,381 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:java.compiler"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("NA"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,381 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:os.name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Linux\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,382 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:os.arch"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amd64\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,382 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:os.version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.4")]),s._v(".0-98-generic\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,386 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:user.name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,386 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:user.home"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,386 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:Environment@100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Client environment:user.dir"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/zookeeper-3.4.10\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,389 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main:ZooKeeper@438"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Initiating client connection, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connectString")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2181 "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sessionTimeout")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("watcher")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("org.apache.zookeeper.ZooKeeperMain"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MyWatcher")]),s._v("@3eb07fd3\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,428 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main-SendThread"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2181"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":ClientCnxn"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SendThread")]),s._v("@1032"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Opening socket connection to server "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130/192.168.75.130:2181. Will not attempt to authenticate using SASL "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("unknown error"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nWelcome to ZooKeeper"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nJLine support is enabled\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,529 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main-SendThread"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2181"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":ClientCnxn"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SendThread")]),s._v("@876"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Socket connection established to "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130/192.168.75.130:2181, initiating session\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zk: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2181"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CONNECTING"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-11-09 07:45:58,573 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myid:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - INFO  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main-SendThread"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2181"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":ClientCnxn"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SendThread")]),s._v("@1299"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" - Session establishment complete on server "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130/192.168.75.130:2181, sessionid "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x15f9fbc12ec0000, negotiated "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n\nWATCHER::\n\nWatchedEvent state:SyncConnected type:None path:null\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])]),e("ul",[e("li",[s._v("使用服务端工具检查服务器状态")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("bash-4.3"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/zkServer.sh status")]),s._v("\nZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nMode: standalone\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"集群模式"}},[s._v("集群模式")]),s._v(" "),e("h4",{attrs:{id:"第一台主机"}},[s._v("第一台主机")]),s._v(" "),e("h4",{attrs:{id:"docker-compose-yml-2"}},[s._v("docker-compose.yml")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("version: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\nservices:\n    zoo1:\n        image: zookeeper\n        restart: always\n        environment:\n            ZOO_MY_ID: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n            ZOO_SERVERS: server.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2888:3888 server.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.134:2888:3888 server.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.135:2888:3888\n        network_mode: "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"验证测试"}},[s._v("验证测试")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("root@UbuntuBase:/usr/local/docker/zookeeper"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it zookeeper_zoo1_1 /bin/bash")]),s._v("\nbash-4.3"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/zkServer.sh status")]),s._v("\nZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nMode: leader\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"第二台主机"}},[s._v("第二台主机")]),s._v(" "),e("h4",{attrs:{id:"docker-compose-yml-3"}},[s._v("docker-compose.yml")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("\nversion: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\nservices:\n    zoo2:\n        image: zookeeper\n        restart: always\n        environment:\n            ZOO_MY_ID: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n            ZOO_SERVERS: server.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2888:3888 server.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.134:2888:3888 server.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.135:2888:3888\n        network_mode: "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"验证测试-2"}},[s._v("验证测试")]),s._v(" "),e("p",[s._v("root@UbuntuBase:/usr/local/docker/zookeeper# docker exec -it zookeeper_zoo2_1 /bin/bash\nbash-4.3# ./bin/zkServer.sh status\nZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nMode: follower")]),s._v(" "),e("h4",{attrs:{id:"第三台主机"}},[s._v("第三台主机")]),s._v(" "),e("h4",{attrs:{id:"docker-compose-yml-4"}},[s._v("docker-compose.yml")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("version: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\nservices:\n    zoo3:\n        image: zookeeper\n        restart: always\n        environment:\n            ZOO_MY_ID: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n            ZOO_SERVERS: server.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.130:2888:3888 server.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.134:2888:3888 server.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".75.135:2888:3888\n        network_mode: "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"验证测试-3"}},[s._v("验证测试")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("root@UbuntuBase:/usr/local/docker/zookeeper"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it zookeeper_zoo3_1 /bin/bash")]),s._v("\nbash-4.3"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/zkServer.sh status")]),s._v("\nZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nMode: follower\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("伪集群模式")]),s._v(" "),e("h1",{attrs:{id:"docker-compose-yml-5"}},[s._v("docker-compose.yml")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("version: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\nservices:\n    zoo1:\n        image: zookeeper\n        restart: always\n        hostname: zoo1\n        ports:\n            - "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v(":2181\n        environment:\n            ZOO_MY_ID: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n            ZOO_SERVERS: server.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo1:2888:3888 server.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo2:2888:3888 server.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo3:2888:3888\n\n    zoo2:\n        image: zookeeper\n        restart: always\n        hostname: zoo2\n        ports:\n            - "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2182")]),s._v(":2181\n        environment:\n            ZOO_MY_ID: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n            ZOO_SERVERS: server.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo1:2888:3888 server.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo2:2888:3888 server.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo3:2888:3888\n\n    zoo3:\n        image: zookeeper\n        restart: always\n        hostname: zoo3\n        ports:\n            - "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2183")]),s._v(":2181\n        environment:\n            ZOO_MY_ID: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n            ZOO_SERVERS: server.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo1:2888:3888 server.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo2:2888:3888 server.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zoo3:2888:3888\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br")])]),e("h4",{attrs:{id:"验证是否安装成功-2"}},[s._v("验证是否安装成功")]),s._v(" "),e("ul",[e("li",[s._v("分别以交互方式进入容器查看")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it zookeeper_zoo1_1 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it zookeeper_zoo2_1 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it zookeeper_zoo3_1 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("使用服务端工具检查服务器状态")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("root@UbuntuBase:/usr/local/docker/zookeeper"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it zookeeper_zoo1_1 /bin/bash")]),s._v("\nbash-4.3"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/zkServer.sh status")]),s._v("\nZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nMode: follower\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("root@UbuntuBase:/usr/local/docker/zookeeper"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it zookeeper_zoo2_1 /bin/bash")]),s._v("\nbash-4.3"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/zkServer.sh status")]),s._v("\nZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nMode: follower\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("root@UbuntuBase:/usr/local/docker/zookeeper"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it zookeeper_zoo3_1 /bin/bash")]),s._v("\nbash-4.3"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/zkServer.sh status")]),s._v("\nZooKeeper JMX enabled by default\nUsing config: /conf/zoo.cfg\nMode: leader\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("从上面的验证结果可以看出：zoo1 为跟随者，zoo2 为跟随者，zoo3 为领导者")]),s._v(" "),e("h2",{attrs:{id:"附：linux-下手动安装-zookeeper"}},[s._v("附：Linux 下手动安装 Zookeeper")]),s._v(" "),e("p",[s._v("Zookeeper 部署有三种方式，单机模式、集群模式、伪集群模式，以下采用手动安装的方式部署")]),s._v(" "),e("p",[e("strong",[s._v("注意：")]),s._v(" 集群为大于等于3个奇数，如 3、5、7,不宜太多，集群机器多了选举和数据同步耗时长，不稳定。")]),s._v(" "),e("p",[s._v("单机模式")]),s._v(" "),e("h4",{attrs:{id:"下载"}},[s._v("下载")]),s._v(" "),e("p",[s._v("进入要下载的版本的目录，选择 "),e("code",[s._v(".tar.gz")]),s._v(" 文件下载，下载链接：http://archive.apache.org/dist/zookeeper/")]),s._v(" "),e("p",[s._v("####安装\n注意： 需要先安装 "),e("code",[s._v("Java")])]),s._v(" "),e("p",[s._v("使用 tar 解压要安装的目录即可，以 3.4.13 版本为例，解压到 "),e("code",[s._v(" /usr/local/zookeeper-3.4.13")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf zookeeper-3.4.13.tar.gz -C /usr/local\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"配置"}},[s._v("配置")]),s._v(" "),e("p",[s._v("在根目录下创建 data 和 logs 两个目录用于存储数据和日志")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/zookeeper-3.4.13\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" data\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" logs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("在 conf 目录下新建 zoo.cfg 文件，写入以下内容保存")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tickTime")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zookeeper-3.4.13/data\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataLogDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zookeeper-3.4.13/logs\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clientPort")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"启动和停止"}},[s._v("启动和停止")]),s._v(" "),e("p",[s._v("进入 bin 目录，启动、停止、重启和查看当前节点状态")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("./zkServer.sh start\n./zkServer.sh stop\n./zkServer.sh restart\n./zkServer.sh status\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"伪集群模式"}},[s._v("伪集群模式")]),s._v(" "),e("p",[s._v("伪集群模式就是在同一主机启动多个 zookeeper 并组成集群，下边以在 192.168.10.134 主机上创 3 个 zookeeper 组集群为例。")]),s._v(" "),e("p",[s._v("将通过单机模式安装的 zookeeper，复制成 zookeeper1/zookeeper2/zookeeper3 三份")]),s._v(" "),e("h4",{attrs:{id:"zookeeper1"}},[s._v("zookeeper1")]),s._v(" "),e("p",[s._v("修改配置文件")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tickTime")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zookeeper1/data\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataLogDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zookeeper1/logs\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clientPort")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("initLimit")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("syncLimit")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nserver.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:2888:3888\nserver.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:4888:5888\nserver.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:6888:7888\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("设置服务器 ID\necho '1' > data/myid")]),s._v(" "),e("h4",{attrs:{id:"zookeeper2"}},[s._v("zookeeper2")]),s._v(" "),e("p",[s._v("修改配置文件")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tickTime")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zookeeper2/data\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataLogDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zookeeper2/logs\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clientPort")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("initLimit")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("syncLimit")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nserver.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:2888:3888\nserver.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:4888:5888\nserver.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:6888:7888\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("设置服务器 ID")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" data/myid\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"zookeeper3"}},[s._v("zookeeper3")]),s._v(" "),e("p",[s._v("修改配置文件")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tickTime")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zookeeper3/data\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataLogDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zookeeper3/logs\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clientPort")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("initLimit")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("syncLimit")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nserver.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:2888:3888\nserver.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:4888:5888\nserver.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.134:6888:7888\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("设置服务器 ID")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" data/myid\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"启动和停止-2"}},[s._v("启动和停止")]),s._v(" "),e("p",[s._v("分别启动服务器，顺序无所谓")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("\n./zkServer.sh start\n./zkServer.sh stop\n./zkServer.sh restart\n./zkServer.sh status\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"集群模式-2"}},[s._v("集群模式")]),s._v(" "),e("p",[s._v("集群模式就是在不同主机上安装 zookeeper 然后组成集群的模式，操作步骤同上，此处不再赘述")]),s._v(" "),e("h2",{attrs:{id:"zookeeper-配置说明"}},[s._v("Zookeeper 配置说明")]),s._v(" "),e("h3",{attrs:{id:"zookeeper-的三种工作模式"}},[s._v("Zookeeper 的三种工作模式")]),s._v(" "),e("ul",[e("li",[s._v("单机模式：存在单点故障")]),s._v(" "),e("li",[s._v("集群模式：在多台机器上部署 Zookeeper 集群，适合线上环境使用。")]),s._v(" "),e("li",[s._v("伪集群模式：在一台机器同时运行多个 Zookeeper 实例，仍然有单点故障问题，当然，其中配置的端口号要错开的，适合实验环境模拟集群使用。")])]),s._v(" "),e("h3",{attrs:{id:"zookeeper-的三种端口号"}},[s._v("Zookeeper 的三种端口号")]),s._v(" "),e("ul",[e("li",[s._v("2181：客户端连接 Zookeeper 集群使用的监听端口号")]),s._v(" "),e("li",[s._v("3888：选举 leader 使用")]),s._v(" "),e("li",[s._v("2888：集群内机器通讯使用（Leader 和 Follower 之间数据同步使用的端口号，Leader 监听此端口）")])]),s._v(" "),e("h3",{attrs:{id:"zookeeper-单机模式配置文件"}},[s._v("Zookeeper 单机模式配置文件")]),s._v(" "),e("p",[s._v("配置文件路径："),e("code",[s._v("/conf/zoo.cfg")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clientPort")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataLogDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/datalog\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tickTime")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("clientPort：这个端口就是客户端连接 Zookeeper 服务器的端口，Zookeeper 会监听这个端口，接受客户端的访问请求。")]),s._v(" "),e("li",[s._v("dataDir：Zookeeper 保存数据的目录。")]),s._v(" "),e("li",[s._v("dataLogDir：Zookeeper 保存日志的目录。")]),s._v(" "),e("li",[s._v("tickTime：这个时间是作为 Zookeeper 服务器之间或客户端与服务器之间维持心跳的时间间隔，也就是每隔 tickTime 时间就会发送一个心跳。")])]),s._v(" "),e("h3",{attrs:{id:"zookeeper-集群模式配置文件"}},[s._v("Zookeeper 集群模式配置文件")]),s._v(" "),e("p",[s._v("配置文件路径："),e("code",[s._v("/conf/zoo.cfg")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clientPort")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dataLogDir")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/datalog\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tickTime")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("initLimit")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("syncLimit")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nautopurge.snapRetainCount"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nautopurge.purgeInterval"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("maxClientCnxns")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\nserver.1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.1:2888:3888\nserver.2"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.2:2888:3888\nserver.3"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.3:2888:3888\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("ul",[e("li",[s._v("initLimit：配置 Zookeeper 接受客户端（这里所说的客户端不是用户连接 Zookeeper 服务器的客户端，而是 Zookeeper 服务器集群中连接到 Leader 的 Follower 服务器）初始化连接时最长能忍受多少个心跳时间间隔数。当已经超过 initLimit（默认为 10） 个心跳的时间（也就是 tickTime）长度后 Zookeeper 服务器还没有收到客户端的返回信息，那么表明这个客户端连接失败。总的时间长度就是 5 * 2000 = 10 秒")]),s._v(" "),e("li",[s._v("syncLimit：配置 Leader 与 Follower 之间发送消息，请求和应答时间长度，最长不能超过多少个 tickTime 的时间长度，总的时间长度就是 2 * 2000 = 4 秒")]),s._v(" "),e("li",[s._v("定时清理（Zookeeper 从 3.4.0 开始提供了自动清理快照和事务日志的功能）以下两个参数配合使用：\n"),e("ul",[e("li",[s._v("autopurge.purgeInterval：指定了清理频率，单位是小时，需要填写一个 1 或更大的整数，默认是 0，表示不开启自己清理功能。")]),s._v(" "),e("li",[s._v("autopurge.snapRetainCount：指定了需要保留的文件数目。默认是保留 3 个。")])])]),s._v(" "),e("li",[s._v("maxClientCnxns：限制连接到 Zookeeper 的客户端的数量，限制并发连接的数量，它通过 IP 来区分不同的客户端。此配置选项可以用来阻止某些类别的 Dos 攻击。将它设置为 0 或者忽略而不进行设置将会取消对并发连接的限制。")]),s._v(" "),e("li",[s._v("server.A=B：C：D：其中 A 是一个数字，表示这个是第几号服务器。B 是这个服务器的 IP 地址。C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口(2888)；D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader，而这个端口就是用来执行选举时服务器相互通信的端口(3888)。如果是伪集群的配置方式，由于 B 都是一样，所以不同的 Zookeeper 实例通信端口号不能一样，所以要给它们分配不同的端口号。\n注意： server.A 中的 A 是在 dataDir 配置的目录中创建一个名为 myid 的文件里的值（如：1）")])]),s._v(" "),e("h4",{attrs:{id:"zookeeper-常用命令"}},[s._v("Zookeeper 常用命令")]),s._v(" "),e("h4",{attrs:{id:"zkserver"}},[s._v("zkServer")]),s._v(" "),e("p",[s._v("启动服务")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("./zkServer.sh start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("停止服务")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("./zkServer.sh stop\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("重启服务")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("./zkServer.sh restart\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("执行状态")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("./zkServer.sh status\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"zkclient"}},[s._v("zkClient")]),s._v(" "),e("p",[s._v("客户端连接服务器并进入 Bash 模式")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("./zkCli.sh -server "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("ip"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"命令参数"}},[s._v("命令参数")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("ZooKeeper -server host:port cmd args\n\t"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" path "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("watch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" path data "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("version"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" path "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("watch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\tdelquota "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-b"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" path\n\tls2 path "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("watch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\tsetAcl path acl\n\tsetquota -n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-b val path\n\t"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" \n\tredo cmdno\n\tprintwatches on"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("off\n\tdelete path "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("version"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v(" path\n\tlistquota path\n\trmr path\n\tget path "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("watch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\tcreate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" path data acl\n\taddauth scheme auth\n\tquit \n\tgetAcl path\n\tclose \n\tconnect host:port\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("ul",[e("li",[s._v("创建节点（Bash 模式）")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("create /test "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello zookeeper"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("查询节点（Bash 模式）")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("get /test\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#### 输出如下")]),s._v("\nHello Zookeeper\ncZxid "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x100000004\nctime "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Fri Oct "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" 05:11:47 GMT "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("\nmZxid "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x100000004\nmtime "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Fri Oct "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" 05:11:47 GMT "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("\npZxid "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x100000004\ncversion "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndataVersion "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\naclVersion "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nephemeralOwner "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x0\ndataLength "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("\nnumChildren "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("ul",[e("li",[s._v("删除节点（Bash 模式）")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("delete\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])},[],!1,null,null,null);a.default=n.exports}}]);